[INFO] Scanning for projects...
[INFO] 
[INFO] ----------------------< uk.gov.pay:pay-connector >----------------------
[INFO] Building pay-connector 0.1-SNAPSHOT
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- maven-clean-plugin:3.2.0:clean (default-clean) @ pay-connector ---
[INFO] Deleting /home/gabsko/breaking-updates/target
[INFO] 
[INFO] --- maven-resources-plugin:3.2.0:copy-resources (copy-resources) @ pay-connector ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Using 'UTF-8' encoding to copy filtered properties files.
[INFO] Copying 1 resource
[INFO] 
[INFO] --- maven-resources-plugin:3.2.0:resources (default-resources) @ pay-connector ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Using 'UTF-8' encoding to copy filtered properties files.
[INFO] Copying 23 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.10.1:compile (default-compile) @ pay-connector ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 739 source files to /home/gabsko/breaking-updates/target/classes
[INFO] /home/gabsko/breaking-updates/src/main/java/uk/gov/pay/connector/gateway/ClientFactory.java: Some input files use or override a deprecated API.
[INFO] /home/gabsko/breaking-updates/src/main/java/uk/gov/pay/connector/gateway/ClientFactory.java: Recompile with -Xlint:deprecation for details.
[INFO] /home/gabsko/breaking-updates/src/main/java/uk/gov/pay/connector/events/model/EventFactory.java: Some input files use unchecked or unsafe operations.
[INFO] /home/gabsko/breaking-updates/src/main/java/uk/gov/pay/connector/events/model/EventFactory.java: Recompile with -Xlint:unchecked for details.
[INFO] 
[INFO] --- maven-resources-plugin:3.2.0:testResources (default-testResources) @ pay-connector ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Using 'UTF-8' encoding to copy filtered properties files.
[INFO] Copying 165 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.10.1:testCompile (default-testCompile) @ pay-connector ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 429 source files to /home/gabsko/breaking-updates/target/test-classes
[INFO] /home/gabsko/breaking-updates/src/test/java/uk/gov/pay/connector/model/domain/EmailCollectionModeTest.java: Some input files use or override a deprecated API.
[INFO] /home/gabsko/breaking-updates/src/test/java/uk/gov/pay/connector/model/domain/EmailCollectionModeTest.java: Recompile with -Xlint:deprecation for details.
[INFO] /home/gabsko/breaking-updates/src/test/java/uk/gov/pay/connector/matcher/ResponseContainsLinkMatcher.java: Some input files use unchecked or unsafe operations.
[INFO] /home/gabsko/breaking-updates/src/test/java/uk/gov/pay/connector/matcher/ResponseContainsLinkMatcher.java: Recompile with -Xlint:unchecked for details.
[INFO] 
[INFO] --- maven-surefire-plugin:3.0.0-M7:test (default-test) @ pay-connector ---
[INFO] Using auto detected provider org.apache.maven.surefire.junitplatform.JUnitPlatformProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running uk.gov.pay.connector.gateway.model.AuthCardDetailsTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.049 s - in uk.gov.pay.connector.gateway.model.AuthCardDetailsTest
[INFO] Running uk.gov.pay.connector.gateway.worldpay.WorldpayRefundHandlerTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.648 s - in uk.gov.pay.connector.gateway.worldpay.WorldpayRefundHandlerTest
[INFO] Running uk.gov.pay.connector.gateway.worldpay.WorldpayAuthorisationRequestSummaryTest
[INFO] Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.26 s - in uk.gov.pay.connector.gateway.worldpay.WorldpayAuthorisationRequestSummaryTest
[INFO] Running uk.gov.pay.connector.gateway.worldpay.WorldpayCredentialsValidationServiceTest
[INFO] Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.389 s - in uk.gov.pay.connector.gateway.worldpay.WorldpayCredentialsValidationServiceTest
[INFO] Running uk.gov.pay.connector.gateway.worldpay.WorldpayOrderStatusResponseTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.034 s - in uk.gov.pay.connector.gateway.worldpay.WorldpayOrderStatusResponseTest
[INFO] Running uk.gov.pay.connector.gateway.worldpay.WorldpayNotificationServiceTest
[Fatal Error] :1:8: The element type "not" must be terminated by the matching end-tag "</not>".
[INFO] Tests run: 12, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.225 s - in uk.gov.pay.connector.gateway.worldpay.WorldpayNotificationServiceTest
[INFO] Running uk.gov.pay.connector.gateway.worldpay.Worldpay3dsFlexCredentialsValidationServiceTest
[INFO] Tests run: 11, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.271 s - in uk.gov.pay.connector.gateway.worldpay.Worldpay3dsFlexCredentialsValidationServiceTest
[INFO] Running uk.gov.pay.connector.gateway.worldpay.WorldpayPaymentProviderTest
[INFO] Tests run: 21, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.563 s - in uk.gov.pay.connector.gateway.worldpay.WorldpayPaymentProviderTest
[INFO] Running uk.gov.pay.connector.gateway.worldpay.WorldpayAuthoriseHandlerTest
[INFO] Tests run: 19, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.722 s - in uk.gov.pay.connector.gateway.worldpay.WorldpayAuthoriseHandlerTest
[INFO] Running uk.gov.pay.connector.gateway.util.AuthorisationRequestSummaryStringifierTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.012 s - in uk.gov.pay.connector.gateway.util.AuthorisationRequestSummaryStringifierTest
[INFO] Running uk.gov.pay.connector.gateway.util.AuthorisationRequestSummaryStructuredLoggingTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.014 s - in uk.gov.pay.connector.gateway.util.AuthorisationRequestSummaryStructuredLoggingTest
[INFO] Running uk.gov.pay.connector.gateway.smartpay.SmartpayNotificationServiceTest
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.fasterxml.jackson.databind.util.ClassUtil (file:/home/gabsko/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.13.3/jackson-databind-2.13.3.jar) to constructor java.util.Optional()
WARNING: Please consider reporting this to the maintainers of com.fasterxml.jackson.databind.util.ClassUtil
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
[INFO] Tests run: 11, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.128 s - in uk.gov.pay.connector.gateway.smartpay.SmartpayNotificationServiceTest
[INFO] Running uk.gov.pay.connector.gateway.smartpay.SmartpayAuthorisationRequestSummaryTest
[INFO] Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.009 s - in uk.gov.pay.connector.gateway.smartpay.SmartpayAuthorisationRequestSummaryTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.handler.StripeFailedPaymentFeeCollectionHandlerTest
[INFO] Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.098 s - in uk.gov.pay.connector.gateway.stripe.handler.StripeFailedPaymentFeeCollectionHandlerTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.StripeNotificationServiceTest
[INFO] Tests run: 24, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.233 s - in uk.gov.pay.connector.gateway.stripe.StripeNotificationServiceTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.StripeAuthorisationRequestSummaryTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 s - in uk.gov.pay.connector.gateway.stripe.StripeAuthorisationRequestSummaryTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.request.StripeTransferMetadataReasonTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 s - in uk.gov.pay.connector.gateway.stripe.request.StripeTransferMetadataReasonTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.request.StripePostRequestTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.041 s - in uk.gov.pay.connector.gateway.stripe.request.StripePostRequestTest
[INFO] Running uk.gov.pay.connector.gateway.epdq.EpdqAuthorisationRequestSummaryTest
[INFO] Tests run: 8, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 s - in uk.gov.pay.connector.gateway.epdq.EpdqAuthorisationRequestSummaryTest
[INFO] Running uk.gov.pay.connector.gateway.epdq.EpdqNotificationServiceStatusMapperTest
[INFO] Tests run: 30, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.085 s - in uk.gov.pay.connector.gateway.epdq.EpdqNotificationServiceStatusMapperTest
[INFO] Running uk.gov.pay.connector.gateway.epdq.EpdqNotificationServiceTest
[INFO] Tests run: 11, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.013 s - in uk.gov.pay.connector.gateway.epdq.EpdqNotificationServiceTest
[INFO] Running uk.gov.pay.connector.gateway.sandbox.SandboxNotificationServiceTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.gateway.sandbox.SandboxNotificationServiceTest
[INFO] Running uk.gov.pay.connector.gateway.sandbox.SandboxAuthorisationRequestSummaryTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.gateway.sandbox.SandboxAuthorisationRequestSummaryTest
[INFO] Running uk.gov.pay.connector.gateway.sandbox.SandboxPaymentProviderTest
[INFO] Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.01 s - in uk.gov.pay.connector.gateway.sandbox.SandboxPaymentProviderTest
[INFO] Running uk.gov.pay.connector.gatewayaccountcredentials.resource.GatewayAccountCredentialsResourceTest
[INFO] Tests run: 21, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1 s - in uk.gov.pay.connector.gatewayaccountcredentials.resource.GatewayAccountCredentialsResourceTest
[INFO] Running uk.gov.pay.connector.gatewayaccountcredentials.service.GatewayAccountCredentialsServiceTest
ERROR [2023-02-04 21:12:23,710] uk.gov.pay.connector.util.ResponseUtil: [Multiple usable credentials exist for payment provider [%s], unable to determine which to use.]
WARN  [2023-02-04 21:12:23,714] uk.gov.pay.connector.gatewayaccount.model.GatewayAccountEntity: Gateway account [id=1] has multiple credentials but no active credential found
[INFO] Tests run: 37, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.054 s - in uk.gov.pay.connector.gatewayaccountcredentials.service.GatewayAccountCredentialsServiceTest
[INFO] Running uk.gov.pay.connector.charge.model.domain.FeeTypeConverterTest
[INFO] Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 s - in uk.gov.pay.connector.charge.model.domain.FeeTypeConverterTest
[INFO] Running uk.gov.pay.connector.charge.model.SourceDeserialiserTest
[INFO] Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.132 s - in uk.gov.pay.connector.charge.model.SourceDeserialiserTest
[INFO] Running uk.gov.pay.connector.charge.resource.ChargesFrontendResourceTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.13 s - in uk.gov.pay.connector.charge.resource.ChargesFrontendResourceTest
[INFO] Running uk.gov.pay.connector.charge.resource.ChargesApiResourceTest
ERROR [2023-02-04 21:12:24,106] uk.gov.pay.connector.util.JsonMappingExceptionMapper: Cannot deserialize value of type `uk.gov.service.payments.commons.model.AuthorisationMode` from String "foo": not one of the values accepted for Enum class: [moto_api, agreement, external, web]
 at [Source: (org.glassfish.jersey.message.internal.ReaderInterceptorExecutor$UnCloseableInputStream); line: 1, column: 36] (through reference chain: uk.gov.pay.connector.charge.model.ChargeCreateRequest["authorisation_mode"])
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.114 s - in uk.gov.pay.connector.charge.resource.ChargesApiResourceTest
[INFO] Running uk.gov.pay.connector.charge.validation.ReturnUrlValidatorTest
[INFO] Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.011 s - in uk.gov.pay.connector.charge.validation.ReturnUrlValidatorTest
[INFO] Running uk.gov.pay.connector.charge.service.ChargeEligibleForCaptureServiceTest
ERROR [2023-02-04 21:12:24,151] uk.gov.pay.connector.charge.service.ChargeEligibleForCaptureService: Exception sending charge [oo1d9j0qn2urns488er4n1npaq] to capture queue
[INFO] Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.027 s - in uk.gov.pay.connector.charge.service.ChargeEligibleForCaptureServiceTest
[INFO] Running uk.gov.pay.connector.charge.service.ChargeServicePostAuthorisationTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.096 s - in uk.gov.pay.connector.charge.service.ChargeServicePostAuthorisationTest
[INFO] Running uk.gov.pay.connector.charge.service.ChargeServiceCreateAgreementTest
[INFO] Tests run: 18, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.078 s - in uk.gov.pay.connector.charge.service.ChargeServiceCreateAgreementTest
[INFO] Running uk.gov.pay.connector.charge.service.LinkPaymentInstrumentToAgreementServiceTest
ERROR [2023-02-04 21:12:24,347] uk.gov.pay.connector.charge.service.LinkPaymentInstrumentToAgreementService: Charge mi7pee51dtb83t534vjeup12vp references agreement I am very agreeable but that agreement does not exist
ERROR [2023-02-04 21:12:24,349] uk.gov.pay.connector.charge.service.LinkPaymentInstrumentToAgreementService: Expected charge l9ihu0rtfacntvmpk6mojte38g to have a payment instrument but it does not have one
ERROR [2023-02-04 21:12:24,350] uk.gov.pay.connector.charge.service.LinkPaymentInstrumentToAgreementService: Expected charge 4apo0a8ip67epkq14hi9impt6f to have an agreement but it does not have one
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.01 s - in uk.gov.pay.connector.charge.service.LinkPaymentInstrumentToAgreementServiceTest
[INFO] Running uk.gov.pay.connector.charge.service.DelayedCaptureServiceTest
ERROR [2023-02-04 21:12:24,363] uk.gov.pay.connector.charge.service.DelayedCaptureService: Exception sending charge [2q8r5e8b2u45pahv68h9t45kev] to capture queue
[INFO] Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.016 s - in uk.gov.pay.connector.charge.service.DelayedCaptureServiceTest
[INFO] Running uk.gov.pay.connector.charge.service.ChargeServiceCreateTest
[INFO] Tests run: 18, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.11 s - in uk.gov.pay.connector.charge.service.ChargeServiceCreateTest
[INFO] Running uk.gov.pay.connector.charge.service.ChargeServiceFindTest
[INFO] Tests run: 15, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.041 s - in uk.gov.pay.connector.charge.service.ChargeServiceFindTest
[INFO] Running uk.gov.pay.connector.charge.service.motoapi.MotoApiCardNumberValidationServiceTest
[INFO] Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.02 s - in uk.gov.pay.connector.charge.service.motoapi.MotoApiCardNumberValidationServiceTest
[INFO] Running uk.gov.pay.connector.charge.service.ChargeServiceCreateTelephonePaymentTest
[INFO] Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.03 s - in uk.gov.pay.connector.charge.service.ChargeServiceCreateTelephonePaymentTest
[INFO] Running uk.gov.pay.connector.charge.service.ChargeServiceTest
[INFO] Tests run: 16, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.047 s - in uk.gov.pay.connector.charge.service.ChargeServiceTest
[INFO] Running uk.gov.pay.connector.charge.service.ChargeServiceCreatePrefilledCardholderDetailsTest
[INFO] Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.017 s - in uk.gov.pay.connector.charge.service.ChargeServiceCreatePrefilledCardholderDetailsTest
[INFO] Running uk.gov.pay.connector.charge.util.FixedCorporateCardSurchargeCalculatorTest
[INFO] Tests run: 24, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 s - in uk.gov.pay.connector.charge.util.FixedCorporateCardSurchargeCalculatorTest
[INFO] Running uk.gov.pay.connector.charge.util.StripeFeeCalculatorTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.charge.util.StripeFeeCalculatorTest
[INFO] Running uk.gov.pay.connector.charge.util.RefundCalculatorTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 s - in uk.gov.pay.connector.charge.util.RefundCalculatorTest
[INFO] Running uk.gov.pay.connector.charge.util.CorporateCardSurchargeCalculatorTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.charge.util.CorporateCardSurchargeCalculatorTest
[INFO] Running uk.gov.pay.connector.charge.util.AuthCardDetailsToCardDetailsEntityConverterTest
[INFO] Tests run: 8, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.009 s - in uk.gov.pay.connector.charge.util.AuthCardDetailsToCardDetailsEntityConverterTest
[INFO] Running uk.gov.pay.connector.service.GatewayAccountServiceTest
[INFO] Tests run: 42, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.084 s - in uk.gov.pay.connector.service.GatewayAccountServiceTest
[INFO] Running uk.gov.pay.connector.service.RefundServiceTest
WARN  [2023-02-04 21:12:24,833] uk.gov.pay.connector.refund.service.RefundService: Charge not available for refund - charge_external_id=chargeId, status=EXTERNAL_SUBMITTED, refund_status=unavailable, account_id=2, operation_type=Refund, provider=sandbox, provider_type=test
[INFO] Tests run: 21, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.101 s - in uk.gov.pay.connector.service.RefundServiceTest
[INFO] Running uk.gov.pay.connector.service.GatewayClientTest
WARN  [2023-02-04 21:12:24,862] uk.gov.pay.connector.gateway.GatewayClient: Exception for gateway url=http://www.example.com/worldpay/order, error message: java.net.SocketException: socket failed
! java.net.SocketException: socket failed
! at uk.gov.pay.connector.service.GatewayClientTest.shouldReturnGatewayErrorWhenProviderFailsWithAProcessingException(GatewayClientTest.java:92)
! ... 70 common frames omitted
! Causing: javax.ws.rs.ProcessingException: java.net.SocketException: socket failed
! at uk.gov.pay.connector.gateway.GatewayClient.lambda$postRequestFor$2(GatewayClient.java:72)
! at uk.gov.pay.connector.gateway.GatewayClient.executeRequest(GatewayClient.java:121)
! at uk.gov.pay.connector.gateway.GatewayClient.postRequestFor(GatewayClient.java:75)
! at uk.gov.pay.connector.gateway.GatewayClient.postRequestFor(GatewayClient.java:48)
! at uk.gov.pay.connector.service.GatewayClientTest.lambda$shouldReturnGatewayErrorWhenProviderFailsWithAProcessingException$2(GatewayClientTest.java:97)
! at org.junit.jupiter.api.AssertThrows.assertThrows(AssertThrows.java:55)
! at org.junit.jupiter.api.AssertThrows.assertThrows(AssertThrows.java:37)
! at org.junit.jupiter.api.Assertions.assertThrows(Assertions.java:3082)
! at uk.gov.pay.connector.service.GatewayClientTest.shouldReturnGatewayErrorWhenProviderFailsWithAProcessingException(GatewayClientTest.java:96)
! at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
! at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
! at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
! at java.base/java.lang.reflect.Method.invoke(Method.java:566)
! at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
! at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
! at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
! at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
! at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
! at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
! at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
! at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
! at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
! at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
! at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
! at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
! at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
! at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
! at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:214)
! at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
! at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:210)
! at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:135)
! at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
! at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
! at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
! at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
! at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
! at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
! at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
! at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
! at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
! at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
! at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
! at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
! at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
! at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
! at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
! at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
! at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
! at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
! at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
! at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
! at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
! at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
! at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
! at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
! at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
! at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:55)
! at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:223)
! at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:175)
! at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:139)
! at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:456)
! at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:169)
! at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:595)
! at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:581)
WARN  [2023-02-04 21:12:24,866] uk.gov.pay.connector.gateway.GatewayClient: Exception for gateway url=http://www.example.com/worldpay/order, error message: java.net.SocketException: socket failed
! java.net.SocketException: socket failed
! at uk.gov.pay.connector.service.GatewayClientTest.getRequestShouldReturnGatewayErrorWhenProviderFailsWithAProcessingException(GatewayClientTest.java:132)
! ... 70 common frames omitted
! Causing: javax.ws.rs.ProcessingException: java.net.SocketException: socket failed
! at uk.gov.pay.connector.gateway.GatewayClient.lambda$getRequestFor$5(GatewayClient.java:105)
! at uk.gov.pay.connector.gateway.GatewayClient.executeRequest(GatewayClient.java:121)
! at uk.gov.pay.connector.gateway.GatewayClient.getRequestFor(GatewayClient.java:108)
! at uk.gov.pay.connector.service.GatewayClientTest.lambda$getRequestShouldReturnGatewayErrorWhenProviderFailsWithAProcessingException$5(GatewayClientTest.java:135)
! at org.junit.jupiter.api.AssertThrows.assertThrows(AssertThrows.java:55)
! at org.junit.jupiter.api.AssertThrows.assertThrows(AssertThrows.java:37)
! at org.junit.jupiter.api.Assertions.assertThrows(Assertions.java:3082)
! at uk.gov.pay.connector.service.GatewayClientTest.getRequestShouldReturnGatewayErrorWhenProviderFailsWithAProcessingException(GatewayClientTest.java:134)
! at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
! at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
! at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
! at java.base/java.lang.reflect.Method.invoke(Method.java:566)
! at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
! at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
! at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
! at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
! at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
! at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
! at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
! at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
! at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
! at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
! at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
! at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
! at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
! at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
! at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:214)
! at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
! at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:210)
! at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:135)
! at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
! at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
! at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
! at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
! at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
! at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
! at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
! at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
! at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
! at java.base/java.util.ArrayList.forEach(ArrayList.java:1541)
! at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
! at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
! at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
! at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
! at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
! at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
! at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
! at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
! at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
! at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
! at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
! at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
! at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
! at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
! at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
! at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
! at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:55)
! at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:223)
! at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:175)
! at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:139)
! at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:456)
! at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:169)
! at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:595)
! at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:581)
WARN  [2023-02-04 21:12:24,869] uk.gov.pay.connector.gateway.GatewayClient: Gateway returned unexpected status code: 500, for gateway url=http://www.example.com/worldpay/order with type test with order request type authorise
WARN  [2023-02-04 21:12:24,874] uk.gov.pay.connector.gateway.GatewayClient: Gateway returned unexpected status code: 500, for gateway url=http://www.example.com/worldpay/order with type test with order request type query
[INFO] Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.026 s - in uk.gov.pay.connector.service.GatewayClientTest
[INFO] Running uk.gov.pay.connector.gatewayaccount.model.GatewayAccountResourceDTOTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.gatewayaccount.model.GatewayAccountResourceDTOTest
[INFO] Running uk.gov.pay.connector.gatewayaccount.model.GatewayAccountEntityTest
WARN  [2023-02-04 21:12:24,882] uk.gov.pay.connector.gatewayaccount.model.GatewayAccountEntity: Gateway account [id=1] has multiple credentials but no active credential found
WARN  [2023-02-04 21:12:24,884] uk.gov.pay.connector.gatewayaccount.model.GatewayAccountEntity: Gateway account [id=1] has multiple credentials but no active credential found
WARN  [2023-02-04 21:12:24,885] uk.gov.pay.connector.gatewayaccount.model.GatewayAccountEntity: Gateway account [id=1] has multiple credentials but no active credential found
[INFO] Tests run: 17, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 s - in uk.gov.pay.connector.gatewayaccount.model.GatewayAccountEntityTest
[INFO] Running uk.gov.pay.connector.gatewayaccount.resource.GatewayAccountResourceSwitchPspValidationTest
ERROR [2023-02-04 21:12:25,001] uk.gov.pay.connector.gatewayaccount.resource.GatewayAccountResource: Switching Payment Provider failure: Account credential with id [04e250be829e4318bf391a1da8394633] not found.
ERROR [2023-02-04 21:12:25,004] uk.gov.pay.connector.gatewayaccount.resource.GatewayAccountResource: Switching Payment Provider failure: Account has no credential to switch to/from
ERROR [2023-02-04 21:12:25,010] uk.gov.pay.connector.gatewayaccount.resource.GatewayAccountResource: Switching Payment Provider failure: Credential with id [31c23900e108406aa0a546a7e37c1e18] is not in correct state.
ERROR [2023-02-04 21:12:25,016] uk.gov.pay.connector.gatewayaccount.resource.GatewayAccountResource: Switching Payment Provider failure: Account credential with ACTIVE state not found.
[INFO] Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.127 s - in uk.gov.pay.connector.gatewayaccount.resource.GatewayAccountResourceSwitchPspValidationTest
[INFO] Running uk.gov.pay.connector.gatewayaccount.resource.GatewayAccountRequestValidatorTest
[INFO] Tests run: 57, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.06 s - in uk.gov.pay.connector.gatewayaccount.resource.GatewayAccountRequestValidatorTest
[INFO] Running uk.gov.pay.connector.gatewayaccount.resource.GatewayAccountResourceValidationTest
ERROR [2023-02-04 21:12:25,172] uk.gov.pay.connector.common.exception.ValidationExceptionMapper: Value [false] must be of type boolean for path [allow_zero_amount]
ERROR [2023-02-04 21:12:25,201] uk.gov.pay.connector.common.exception.ValidationExceptionMapper: Operation [add] is not valid for path [corporate_debit_card_surcharge_amount]
ERROR [2023-02-04 21:12:25,203] uk.gov.pay.connector.common.exception.ValidationExceptionMapper: Value [] is not valid for path [corporate_credit_card_surcharge_amount]
ERROR [2023-02-04 21:12:25,205] uk.gov.pay.connector.common.exception.ValidationExceptionMapper: Value [-100] is not valid for path [corporate_credit_card_surcharge_amount]
ERROR [2023-02-04 21:12:25,207] uk.gov.pay.connector.common.exception.ValidationExceptionMapper: Field [value] is required
ERROR [2023-02-04 21:12:25,208] uk.gov.pay.connector.common.exception.ValidationExceptionMapper: Value [not zero or a positive number that can be represented as a long] is not valid for path [corporate_debit_card_surcharge_amount]
ERROR [2023-02-04 21:12:25,210] uk.gov.pay.connector.common.exception.ValidationExceptionMapper: Field [value] is required
[INFO] Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.132 s - in uk.gov.pay.connector.gatewayaccount.resource.GatewayAccountResourceValidationTest
[INFO] Running uk.gov.pay.connector.gatewayaccount.validation.Worldpay3DsFlexIssuerOrOrganisationalUnitIdValidatorTest
[INFO] Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 s - in uk.gov.pay.connector.gatewayaccount.validation.Worldpay3DsFlexIssuerOrOrganisationalUnitIdValidatorTest
[INFO] Running uk.gov.pay.connector.gatewayaccount.validation.Worldpay3dsFlexJwtMacKeyValidatorTest
[INFO] Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 s - in uk.gov.pay.connector.gatewayaccount.validation.Worldpay3dsFlexJwtMacKeyValidatorTest
[INFO] Running uk.gov.pay.connector.events.model.charge.PaymentNotificationCreatedTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.051 s - in uk.gov.pay.connector.events.model.charge.PaymentNotificationCreatedTest
[INFO] Running uk.gov.pay.connector.events.model.charge.PaymentDetailsSubmittedByAPITest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 s - in uk.gov.pay.connector.events.model.charge.PaymentDetailsSubmittedByAPITest
[INFO] Running uk.gov.pay.connector.events.model.charge.Gateway3dsExemptionResultObtainedTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 s - in uk.gov.pay.connector.events.model.charge.Gateway3dsExemptionResultObtainedTest
[INFO] Running uk.gov.pay.connector.events.model.charge.FeeIncurredEventTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 s - in uk.gov.pay.connector.events.model.charge.FeeIncurredEventTest
[INFO] Running uk.gov.pay.connector.events.model.charge.Gateway3dsInfoObtainedTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 s - in uk.gov.pay.connector.events.model.charge.Gateway3dsInfoObtainedTest
[INFO] Running uk.gov.pay.connector.events.model.charge.PaymentCreatedTest
[INFO] Tests run: 17, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.071 s - in uk.gov.pay.connector.events.model.charge.PaymentCreatedTest
[INFO] Running uk.gov.pay.connector.paymentprocessor.resource.CardResourceTest
[INFO] Tests run: 39, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.3 s - in uk.gov.pay.connector.paymentprocessor.resource.CardResourceTest
[INFO] Running uk.gov.pay.connector.paymentprocessor.service.QueryServiceTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.009 s - in uk.gov.pay.connector.paymentprocessor.service.QueryServiceTest
[INFO] Running uk.gov.pay.connector.paymentprocessor.service.WorldpayCardAuthoriseServiceTest
[INFO] Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.06 s - in uk.gov.pay.connector.paymentprocessor.service.WorldpayCardAuthoriseServiceTest
[INFO] Running uk.gov.pay.connector.paymentprocessor.service.DiscrepancyServiceTest
[INFO] Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.012 s - in uk.gov.pay.connector.paymentprocessor.service.DiscrepancyServiceTest
[INFO] Running uk.gov.pay.connector.paymentprocessor.service.CardAuthoriseServiceTest
WARN  [2023-02-04 21:12:25,805] uk.gov.pay.connector.paymentprocessor.service.AuthorisationService: AuthCardDetails authorisation response received with no transaction id. -  charge_external_id=98a9ko3csaes4d0h0662u9eg5b
WARN  [2023-02-04 21:12:25,809] uk.gov.pay.connector.paymentprocessor.service.AuthorisationService: AuthCardDetails authorisation response received with no transaction id. -  charge_external_id=m907fb5ndka0c1fhuurm13ptbo
WARN  [2023-02-04 21:12:25,812] uk.gov.pay.connector.charge.model.domain.ChargeEntity: Charge with state UNDEFINED cannot proceed to AUTHORISATION READY [charge_external_id=9q8t4otusmt36d57qknqhkclj6, charge_status=AUTHORISATION READY, event=Event{resourceExternalId='null', eventDetails=uk.gov.pay.connector.events.eventdetails.EmptyEventDetails, timestamp=null}]
WARN  [2023-02-04 21:12:25,839] uk.gov.pay.connector.charge.model.domain.ChargeEntity: Charge with state AUTHORISATION READY cannot proceed to AUTHORISATION READY [charge_external_id=4ooekvmoiupcdfj4rg4vjsj987, charge_status=AUTHORISATION READY, event=Event{resourceExternalId='null', eventDetails=uk.gov.pay.connector.events.eventdetails.EmptyEventDetails, timestamp=null}]
WARN  [2023-02-04 21:12:25,845] uk.gov.pay.connector.paymentprocessor.service.AuthorisationService: AuthCardDetails authorisation response received with no transaction id. -  charge_external_id=inv5lg9fktj487o470tjspdbaa
WARN  [2023-02-04 21:12:25,853] uk.gov.pay.connector.paymentprocessor.service.AuthorisationService: AuthCardDetails authorisation response received with no transaction id. -  charge_external_id=s42jr2hefoh03r14fhvom0gcbv
WARN  [2023-02-04 21:12:25,864] uk.gov.pay.connector.paymentprocessor.service.AuthorisationService: AuthCardDetails authorisation response received with no transaction id. -  charge_external_id=5nr9kvelf8phl36j64t6i70r69
WARN  [2023-02-04 21:12:25,869] uk.gov.pay.connector.paymentprocessor.service.AuthorisationService: AuthCardDetails authorisation response received with no transaction id. -  charge_external_id=jpa24ldlj2c7pga7i2c14f7ta0
ERROR [2023-02-04 21:12:25,877] uk.gov.pay.connector.paymentprocessor.service.CardAuthoriseService: AuthCardDetails authorisation failed pre operation. Card brand requires 3ds but Gateway account has 3ds disabled - charge_external_id=lru83supkh8h4ajm45br02qcuu, operation_type=Authorisation, card_brand=visa
WARN  [2023-02-04 21:12:25,885] uk.gov.pay.connector.paymentprocessor.service.AuthorisationService: AuthCardDetails authorisation response received with no transaction id. -  charge_external_id=2gh7ccqgej3js810ppcr741090
WARN  [2023-02-04 21:12:25,894] uk.gov.pay.connector.paymentprocessor.service.AuthorisationService: AuthCardDetails authorisation response received with no transaction id. -  charge_external_id=0krtc7rd2amg1bbmdlfnrsfgoc
WARN  [2023-02-04 21:12:25,901] uk.gov.pay.connector.paymentprocessor.service.AuthorisationService: AuthCardDetails authorisation response received with no transaction id. -  charge_external_id=316n3r2tbmotho0201olg65qgh
WARN  [2023-02-04 21:12:25,919] uk.gov.pay.connector.paymentprocessor.service.AuthorisationService: AuthCardDetails authorisation response received with no transaction id. -  charge_external_id=ck7btjsh0flbnip2sr8b14j490
WARN  [2023-02-04 21:12:25,926] uk.gov.pay.connector.charge.model.domain.ChargeEntity: Charge with state UNDEFINED cannot proceed to AUTHORISATION READY [charge_external_id=d0icrjnga16g5cnml5odi7i661, charge_status=AUTHORISATION READY, event=Event{resourceExternalId='null', eventDetails=uk.gov.pay.connector.events.eventdetails.EmptyEventDetails, timestamp=null}]
[INFO] Tests run: 36, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.17 s - in uk.gov.pay.connector.paymentprocessor.service.CardAuthoriseServiceTest
[INFO] Running uk.gov.pay.connector.paymentinstrument.service.PaymentInstrumentServiceTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 s - in uk.gov.pay.connector.paymentinstrument.service.PaymentInstrumentServiceTest
[INFO] Running uk.gov.pay.connector.util.AcceptLanguageHeaderParserTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.util.AcceptLanguageHeaderParserTest
[INFO] Running uk.gov.pay.connector.util.CidrUtilsTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 s - in uk.gov.pay.connector.util.CidrUtilsTest
[INFO] Running uk.gov.pay.connector.util.IpAddressMatcherTest
[INFO] Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 s - in uk.gov.pay.connector.util.IpAddressMatcherTest
[INFO] Running uk.gov.pay.connector.queue.tasks.TaskQueueServiceTest
WARN  [2023-02-04 21:12:25,952] uk.gov.pay.connector.queue.tasks.TaskQueueService: Error adding payment task message to queue
ERROR [2023-02-04 21:12:25,984] uk.gov.pay.connector.queue.tasks.TaskQueueService: Error adding task to queue
[INFO] Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.043 s - in uk.gov.pay.connector.queue.tasks.TaskQueueServiceTest
[INFO] Running uk.gov.pay.connector.queue.tasks.TaskQueueMessageHandlerTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.024 s - in uk.gov.pay.connector.queue.tasks.TaskQueueMessageHandlerTest
[INFO] Running uk.gov.pay.connector.queue.tasks.TaskQueueTest
ERROR [2023-02-04 21:12:26,053] uk.gov.pay.connector.queue.tasks.TaskQueue: Error parsing message from tasks queue
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.041 s - in uk.gov.pay.connector.queue.tasks.TaskQueueTest
[INFO] Running uk.gov.pay.connector.queue.tasks.StripeWebhookTaskHandlerTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.014 s - in uk.gov.pay.connector.queue.tasks.StripeWebhookTaskHandlerTest
[INFO] Running uk.gov.pay.connector.queue.tasks.CollectFeesForFailedPaymentsTaskHandlerTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.015 s - in uk.gov.pay.connector.queue.tasks.CollectFeesForFailedPaymentsTaskHandlerTest
[INFO] Running uk.gov.pay.connector.wallets.WalletAuthorisationDataToAuthCardDetailsConverterTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.006 s - in uk.gov.pay.connector.wallets.WalletAuthorisationDataToAuthCardDetailsConverterTest
[INFO] Running uk.gov.pay.connector.wallets.applepay.ApplePayDecrypterTest
ERROR [2023-02-04 21:12:26,193] uk.gov.pay.connector.wallets.applepay.ApplePayDecrypter: Error while trying to decrypt apple pay payload: Tag mismatch!
ERROR [2023-02-04 21:12:26,199] uk.gov.pay.connector.wallets.applepay.ApplePayDecrypter: Error while trying to decrypt apple pay payload: java.security.InvalidKeyException: IOException: DerInputStream.getLength(): lengthTag=10, too big.
ERROR [2023-02-04 21:12:26,250] uk.gov.pay.connector.wallets.applepay.ApplePayDecrypter: Error while trying to decrypt apple pay payload: Input too short - need tag
[INFO] Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.157 s - in uk.gov.pay.connector.wallets.applepay.ApplePayDecrypterTest
[INFO] Running uk.gov.pay.connector.it.resources.GatewayAccountResourceTest
[WARNING] Tests run: 2, Failures: 0, Errors: 0, Skipped: 1, Time elapsed: 0.11 s - in uk.gov.pay.connector.it.resources.GatewayAccountResourceTest
[INFO] Running uk.gov.pay.connector.agreement.resource.AgreementsApiResourceTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.138 s - in uk.gov.pay.connector.agreement.resource.AgreementsApiResourceTest
[INFO] Running uk.gov.pay.connector.token.TokenServiceTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 s - in uk.gov.pay.connector.token.TokenServiceTest
[INFO] Running uk.gov.pay.connector.model.domain.EmailNotificationTypeTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 s - in uk.gov.pay.connector.model.domain.EmailNotificationTypeTest
[INFO] Running uk.gov.pay.connector.model.domain.RefundEntityTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 s - in uk.gov.pay.connector.model.domain.RefundEntityTest
[INFO] Running uk.gov.pay.connector.model.domain.HistoryCustomizerTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.227 s - in uk.gov.pay.connector.model.domain.HistoryCustomizerTest
[INFO] Running uk.gov.pay.connector.model.domain.EmailCollectionModeTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.model.domain.EmailCollectionModeTest
[INFO] Running uk.gov.pay.connector.model.domain.JsonToMapConverterTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 s - in uk.gov.pay.connector.model.domain.JsonToMapConverterTest
[INFO] Running uk.gov.pay.connector.model.domain.ChargeEntityTest
WARN  [2023-02-04 21:12:26,765] uk.gov.pay.connector.charge.model.domain.ChargeEntity: Charge with state CREATED cannot proceed to CAPTURED [charge_external_id=mtps5kjtu7b6aka2ca4uruu8c6, charge_status=CAPTURED, event=Event{resourceExternalId='null', eventDetails=uk.gov.pay.connector.events.eventdetails.EmptyEventDetails, timestamp=null}]
[INFO] Tests run: 13, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 s - in uk.gov.pay.connector.model.domain.ChargeEntityTest
[INFO] Running uk.gov.pay.connector.model.domain.RefundStatusMapTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.model.domain.RefundStatusMapTest
[INFO] Running uk.gov.pay.connector.model.LastDigitsCardNumberTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.model.LastDigitsCardNumberTest
[INFO] Running uk.gov.pay.connector.model.TransactionEventTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 s - in uk.gov.pay.connector.model.TransactionEventTest
[INFO] Running uk.gov.pay.connector.model.FirstDigitsCardNumberTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.model.FirstDigitsCardNumberTest
[INFO] Running uk.gov.pay.connector.model.RefundResponseTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.021 s - in uk.gov.pay.connector.model.RefundResponseTest
[INFO] Running uk.gov.pay.connector.client.ledger.service.LedgerServiceTest
ERROR [2023-02-04 21:12:26,804] uk.gov.pay.connector.client.ledger.service.LedgerService: Error processing response from ledger for payment refunds: gateway_account_id=152 payment_external_id=external-id
ERROR [2023-02-04 21:12:26,811] uk.gov.pay.connector.client.ledger.service.LedgerService: Received non-success status code for get refunds for payment from Ledger: gateway_account_id=152, payment_external_id=external-id
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.011 s - in uk.gov.pay.connector.client.ledger.service.LedgerServiceTest
[INFO] Running uk.gov.pay.connector.client.ledger.service.LedgerServiceConsumerTest
WARN  [2023-02-04 21:12:27,716] au.com.dius.pact.model.matchingrules.MatchingRuleGroup: Unrecognised matcher value, defaulting to equality matching
WARN  [2023-02-04 21:12:27,717] au.com.dius.pact.model.matchingrules.MatchingRuleGroup: Unrecognised matcher value, defaulting to equality matching
WARN  [2023-02-04 21:12:28,976] au.com.dius.pact.model.matchingrules.MatchingRuleGroup: Unrecognised matcher value, defaulting to equality matching
WARN  [2023-02-04 21:12:28,976] au.com.dius.pact.model.matchingrules.MatchingRuleGroup: Unrecognised matcher value, defaulting to equality matching
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.855 s - in uk.gov.pay.connector.client.ledger.service.LedgerServiceConsumerTest
[INFO] Running uk.gov.pay.connector.client.cardid.model.CardidServiceConsumerTest
[WARNING] Tests run: 3, Failures: 0, Errors: 0, Skipped: 1, Time elapsed: 1.059 s - in uk.gov.pay.connector.client.cardid.model.CardidServiceConsumerTest
[INFO] Running uk.gov.pay.connector.gateway.model.response.GatewayResponseTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 s - in uk.gov.pay.connector.gateway.model.response.GatewayResponseTest
[INFO] Running uk.gov.pay.connector.gateway.model.request.CardAuthorisationGatewayRequestTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 s - in uk.gov.pay.connector.gateway.model.request.CardAuthorisationGatewayRequestTest
[INFO] Running uk.gov.pay.connector.gateway.worldpay.WorldpayCaptureHandlerTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.062 s - in uk.gov.pay.connector.gateway.worldpay.WorldpayCaptureHandlerTest
[INFO] Running uk.gov.pay.connector.gateway.worldpay.WorldpayOrderRequestBuilderTest
[INFO] Tests run: 18, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.61 s - in uk.gov.pay.connector.gateway.worldpay.WorldpayOrderRequestBuilderTest
[INFO] Running uk.gov.pay.connector.gateway.worldpay.wallets.WorldpayWalletAuthorisationHandlerTest
[INFO] Tests run: 14, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.481 s - in uk.gov.pay.connector.gateway.worldpay.wallets.WorldpayWalletAuthorisationHandlerTest
[INFO] Running uk.gov.pay.connector.gateway.smartpay.SmartpayOrderRequestBuilderTest
[INFO] Tests run: 15, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.068 s - in uk.gov.pay.connector.gateway.smartpay.SmartpayOrderRequestBuilderTest
[INFO] Running uk.gov.pay.connector.gateway.smartpay.SmartpayStatusMapperTest
[INFO] Tests run: 8, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.gateway.smartpay.SmartpayStatusMapperTest
[INFO] Running uk.gov.pay.connector.gateway.smartpay.SmartpayPaymentProviderTest
[INFO] Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.05 s - in uk.gov.pay.connector.gateway.smartpay.SmartpayPaymentProviderTest
[INFO] Running uk.gov.pay.connector.gateway.smartpay.auth.SmartpayAccountSpecificAuthenticatorTest
WARN  [2023-02-04 21:12:32,038] uk.gov.pay.connector.gateway.smartpay.auth.SmartpayAccountSpecificAuthenticator: Authentication failure: failed for smartpay username BasicCredentials{username=MyService, password=**********}
WARN  [2023-02-04 21:12:32,039] uk.gov.pay.connector.gateway.smartpay.auth.SmartpayAccountSpecificAuthenticator: Authentication failure: failed for smartpay username BasicCredentials{username=MyService, password=**********}
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.019 s - in uk.gov.pay.connector.gateway.smartpay.auth.SmartpayAccountSpecificAuthenticatorTest
[INFO] Running uk.gov.pay.connector.gateway.smartpay.SmartpayCaptureHandlerTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.013 s - in uk.gov.pay.connector.gateway.smartpay.SmartpayCaptureHandlerTest
[INFO] Running uk.gov.pay.connector.gateway.smartpay.SmartpayNotificationTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.006 s - in uk.gov.pay.connector.gateway.smartpay.SmartpayNotificationTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.StripeCaptureHandlerTest
WARN  [2023-02-04 21:12:32,074] uk.gov.pay.connector.gateway.stripe.handler.StripeCaptureHandler: Capture failed for transaction id ch_1231231123123. Reason: uh oh. Status code from Stripe: Optional[500]. Charge External Id: d0nmcjkccm0j0fupkltjqjq0su
WARN  [2023-02-04 21:12:32,093] uk.gov.pay.connector.gateway.stripe.handler.StripeCaptureHandler: Capture failed for transaction id ch_1231231123123. Reason: uh oh. Status code from Stripe: Optional[500]. Charge External Id: 4fechp0p0lign2jhfa4paoqgrt
WARN  [2023-02-04 21:12:32,099] uk.gov.pay.connector.gateway.stripe.handler.StripeCaptureHandler: Capture failed for transaction id ch_1231231123123. Failure code from Stripe: resource_missing, failure message from Stripe: No such charge: ch_123456 or something similar. External Charge id: 9v4rfnfj1ugfj8tmjb126jg584. Response code from Stripe: Optional[401]
WARN  [2023-02-04 21:12:32,108] uk.gov.pay.connector.gateway.stripe.handler.StripeCaptureHandler: Capture failed for transaction id ch_1231231123123. Failure code from Stripe: resource_missing, failure message from Stripe: No such charge: ch_123456 or something similar. External Charge id: gvcopjagda280ajss8dcr1gmqq. Response code from Stripe: Optional[401]
[INFO] Tests run: 11, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.049 s - in uk.gov.pay.connector.gateway.stripe.StripeCaptureHandlerTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.StripePaymentProviderTest
ERROR [2023-02-04 21:12:32,118] uk.gov.pay.connector.gateway.stripe.handler.StripeAuthoriseHandler: Authorisation failed due to an internal error. Reason: server error. Status code from Stripe: 500.
ERROR [2023-02-04 21:12:32,145] uk.gov.pay.connector.gateway.stripe.handler.StripeAuthoriseHandler: GatewayException occurred, error:
 {}
! uk.gov.pay.connector.gateway.GatewayException$GatewayConnectionTimeoutException: javax.ws.rs.ProcessingException: java.io.IOException
! at uk.gov.pay.connector.gateway.stripe.handler.StripeAuthoriseHandler.createPaymentIntent(StripeAuthoriseHandler.java:90)
! at uk.gov.pay.connector.gateway.stripe.handler.StripeAuthoriseHandler.authorise(StripeAuthoriseHandler.java:56)
! at uk.gov.pay.connector.gateway.stripe.StripePaymentProvider.authorise(StripePaymentProvider.java:108)
! at uk.gov.pay.connector.gateway.stripe.StripePaymentProviderTest.shouldNotAuthorise_whenProcessingExceptionIsThrown(StripePaymentProviderTest.java:174)
! at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
! at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
! at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
! at java.base/java.lang.reflect.Method.invoke(Method.java:566)
! at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
! at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
! at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
! at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
! at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
! at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
! at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
! at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
! at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
! at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
! at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
! at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
! at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
! at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
! at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
! at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
! at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
! at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
! at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
! at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:42)
! at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:80)
! at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:72)
! at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
! at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
! at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
! at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
! at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
! at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
! at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
! at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
! at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:55)
! at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:223)
! at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:175)
! at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:139)
! at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:456)
! at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:169)
! at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:595)
! at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:581)
[INFO] Tests run: 15, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.037 s - in uk.gov.pay.connector.gateway.stripe.StripePaymentProviderTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.json.StripePayoutStatusTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.gateway.stripe.json.StripePayoutStatusTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.json.StripePayoutTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 s - in uk.gov.pay.connector.gateway.stripe.json.StripePayoutTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.StripeCancelHandlerTest
ERROR [2023-02-04 21:12:32,153] uk.gov.pay.connector.gateway.stripe.handler.StripeCancelHandler: Cancel failed for gateway transaction id ch_1231231123123. Failure message from Stripe: stripe server error. Charge External Id: 5q58opvmekmtc617ob5svua0kj. Response code from Stripe: Optional[503]
ERROR [2023-02-04 21:12:32,154] uk.gov.pay.connector.gateway.stripe.handler.StripeCancelHandler: Cancel failed for gateway transaction id ch_1231231123123. Failure message from Stripe: {
  "error": {
    "charge": "ch_aaaaaaaaaaaaaaaaaaaaaaaa",
    "code": "resource_missing",
    "decline_code": "generic_decline",
    "doc_url": "https://stripe.com/docs/error-codes/card-declined",
    "message": "No such charge: ch_123456 or something similar",
    "type": "{{type}}",
    "payment_intent": {
      "id": "pi_aaaaaaaaaaaaaaaaaaaaaaaa",
      "object": "payment_intent",
      "amount": 12000,
      "amount_capturable": 0,
      "charges": {
        "object": "list",
        "data": [
          {
            "id": "ch_aaaaaaaaaaaaaaaaaaaaaaaa",
            "object": "charge",
            "amount": 12000,
            "amount_captured": 0,
            "amount_refunded": 0,
            "application": null,
            "application_fee": null,
            "application_fee_amount": null,
            "balance_transaction": null,
            "billing_details": {
              "address": {
                "city": "Manchester",
                "country": "GB",
                "line1": "Floor 1A City Tower",
                "line2": "Piccadilly Plaza",
                "postal_code": "M1 4BT",
                "state": null
              },
              "email": null,
              "name": "J. Bogs",
              "phone": null
            },
            "calculated_statement_descriptor": "Stripe",
            "captured": false,
            "created": 1641912339,
            "currency": "gbp",
            "customer": null,
            "description": "New passport application",
            "destination": null,
            "dispute": null,
            "disputed": false,
            "failure_code": "card_declined",
            "failure_message": "Your card was declined.",
            "fraud_details": {
            },
            "invoice": null,
            "livemode": false,
            "metadata": {
            },
            "on_behalf_of": "acct_aaaaaaaaaaaaaaaa",
            "order": null,
            "outcome": {
              "network_status": "declined_by_network",
              "reason": "generic_decline",
              "risk_level": "normal",
              "risk_score": 24,
              "seller_message": "The bank did not return any further details with this decline.",
              "type": "issuer_declined"
            },
            "paid": false,
            "payment_intent": "pi_aaaaaaaaaaaaaaaaaaaaaaaa",
            "payment_method": "pm_aaaaaaaaaaaaaaaaaaaaaaaa",
            "payment_method_details": {
              "card": {
                "brand": "visa",
                "checks": {
                  "address_line1_check": "pass",
                  "address_postal_code_check": "pass",
                  "cvc_check": "pass"
                },
                "country": "US",
                "exp_month": 2,
                "exp_year": 2023,
                "fingerprint": "0CFI1ogMdJ3zM4Ey",
                "funding": "credit",
                "installments": null,
                "last4": "0002",
                "network": "visa",
                "three_d_secure": null,
                "wallet": null
              },
              "type": "card"
            },
            "receipt_email": null,
            "receipt_number": null,
            "receipt_url": null,
            "refunded": false,
            "refunds": {
              "object": "list",
              "data": [
              ],
              "has_more": false,
              "total_count": 0,
              "url": "/v1/charges/ch_aaaaaaaaaaaaaaaaaaaaaaaa/refunds"
            },
            "review": null,
            "shipping": null,
            "source": null,
            "source_transfer": null,
            "statement_descriptor": null,
            "statement_descriptor_suffix": null,
            "status": "failed",
            "transfer_data": null
          }
        ]
      }
    }
  }
}. Charge External Id: 5nolnak3vkkfeo301edud6j4d8. Response code from Stripe: Optional[400]
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 s - in uk.gov.pay.connector.gateway.stripe.StripeCancelHandlerTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.handler.StripeQueryPaymentStatusHandlerTest
[INFO] Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.014 s - in uk.gov.pay.connector.gateway.stripe.handler.StripeQueryPaymentStatusHandlerTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.request.StripeCaptureRequestTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 s - in uk.gov.pay.connector.gateway.stripe.request.StripeCaptureRequestTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.request.StripePaymentIntentRequestTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 s - in uk.gov.pay.connector.gateway.stripe.request.StripePaymentIntentRequestTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.request.StripeTransferOutRequestTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 s - in uk.gov.pay.connector.gateway.stripe.request.StripeTransferOutRequestTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.request.StripeTransferInRequestTest
[INFO] Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.006 s - in uk.gov.pay.connector.gateway.stripe.request.StripeTransferInRequestTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.request.StripePaymentMethodRequestTest
[INFO] Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.01 s - in uk.gov.pay.connector.gateway.stripe.request.StripePaymentMethodRequestTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.request.StripeRefundRequestTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 s - in uk.gov.pay.connector.gateway.stripe.request.StripeRefundRequestTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.request.StripeAuthoriseRequestTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 s - in uk.gov.pay.connector.gateway.stripe.request.StripeAuthoriseRequestTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.request.StripeTransferMetadataTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.gateway.stripe.request.StripeTransferMetadataTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.StripeRefundHandlerTest
ERROR [2023-02-04 21:12:32,218] uk.gov.pay.connector.gateway.stripe.handler.StripeRefundHandler: Refund failed for refund gateway request RefundGatewayRequest[
transactionId: gatewayTransactionId
refundExternalId: someExternalId]. Reason: Problem with Stripe servers. Status code from Stripe: Optional[500].
ERROR [2023-02-04 21:12:32,225] uk.gov.pay.connector.gateway.stripe.handler.StripeRefundHandler: Refund failed for refund gateway request RefundGatewayRequest[
transactionId: gatewayTransactionId
refundExternalId: someExternalId]. Failure code from Stripe: resource_missing, failure message from Stripe: No such charge: ch_123456 or something similar. Response code from Stripe: Optional[402]
ERROR [2023-02-04 21:12:32,229] uk.gov.pay.connector.gateway.stripe.handler.StripeRefundHandler: Refund failed for refund gateway request RefundGatewayRequest[
transactionId: gatewayTransactionId
refundExternalId: someExternalId]. Failure code from Stripe: resource_missing, failure message from Stripe: No such charge: ch_123456 or something similar. Response code from Stripe: Optional[402]
ERROR [2023-02-04 21:12:32,232] uk.gov.pay.connector.gateway.stripe.handler.StripeRefundHandler: Refund failed for refund gateway request RefundGatewayRequest[
transactionId: gatewayTransactionId
refundExternalId: someExternalId]. Reason: Problem with Stripe servers. Status code from Stripe: Optional[500].
[INFO] Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.015 s - in uk.gov.pay.connector.gateway.stripe.StripeRefundHandlerTest
[INFO] Running uk.gov.pay.connector.gateway.stripe.StripeNotificationTypeTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 s - in uk.gov.pay.connector.gateway.stripe.StripeNotificationTypeTest
[INFO] Running uk.gov.pay.connector.gateway.epdq.EpdqPayloadDefinitionForNewOrderTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.009 s - in uk.gov.pay.connector.gateway.epdq.EpdqPayloadDefinitionForNewOrderTest
[INFO] Running uk.gov.pay.connector.gateway.epdq.EpdqPayloadDefinitionForCancelOrderTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 s - in uk.gov.pay.connector.gateway.epdq.EpdqPayloadDefinitionForCancelOrderTest
[INFO] Running uk.gov.pay.connector.gateway.epdq.EpdqPayloadDefinitionForCaptureOrderTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 s - in uk.gov.pay.connector.gateway.epdq.EpdqPayloadDefinitionForCaptureOrderTest
[INFO] Running uk.gov.pay.connector.gateway.epdq.EpdqSha512SignatureGeneratorTest
[INFO] Tests run: 8, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 s - in uk.gov.pay.connector.gateway.epdq.EpdqSha512SignatureGeneratorTest
[INFO] Running uk.gov.pay.connector.gateway.epdq.EpdqPayloadDefinitionForNew3dsOrderTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 s - in uk.gov.pay.connector.gateway.epdq.EpdqPayloadDefinitionForNew3dsOrderTest
[INFO] Running uk.gov.pay.connector.gateway.epdq.payload.EpdqPayloadDefinitionForNew3ds2OrderTest
[INFO] Tests run: 80, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.041 s - in uk.gov.pay.connector.gateway.epdq.payload.EpdqPayloadDefinitionForNew3ds2OrderTest
[INFO] Running uk.gov.pay.connector.gateway.epdq.EpdqNotificationTest
[INFO] Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 s - in uk.gov.pay.connector.gateway.epdq.EpdqNotificationTest
[INFO] Running uk.gov.pay.connector.gateway.epdq.EpdqPayloadDefinitionForRefundOrderTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.gateway.epdq.EpdqPayloadDefinitionForRefundOrderTest
[INFO] Running uk.gov.pay.connector.gateway.epdq.EpdqCaptureHandlerTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.107 s - in uk.gov.pay.connector.gateway.epdq.EpdqCaptureHandlerTest
[INFO] Running uk.gov.pay.connector.gateway.sandbox.applepay.SandboxWalletAuthorisationHandlerTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.gateway.sandbox.applepay.SandboxWalletAuthorisationHandlerTest
[INFO] Running uk.gov.pay.connector.gateway.sandbox.SandboxWalletCardNumbersTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.gateway.sandbox.SandboxWalletCardNumbersTest
[INFO] Running uk.gov.pay.connector.gateway.sandbox.SandboxCardNumbersTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.gateway.sandbox.SandboxCardNumbersTest
[INFO] Running uk.gov.pay.connector.gateway.processor.ChargeNotificationProcessorTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 s - in uk.gov.pay.connector.gateway.processor.ChargeNotificationProcessorTest
[INFO] Running uk.gov.pay.connector.gateway.processor.RefundNotificationProcessorTest
WARN  [2023-02-04 21:12:32,424] uk.gov.pay.connector.gateway.processor.RefundNotificationProcessor: Refund notification could not be used to update charge (missing reference)
WARN  [2023-02-04 21:12:32,426] uk.gov.pay.connector.gateway.processor.RefundNotificationProcessor: WORLDPAY notification could not be processed as refund [someExternalId] has been expunged from connector
WARN  [2023-02-04 21:12:32,427] uk.gov.pay.connector.gateway.processor.RefundNotificationProcessor: WORLDPAY notification 'unknown' could not be used to update refund (associated refund entity not found) for charge [2f1mret9g88pnp0fbmgeu9oss6]
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.006 s - in uk.gov.pay.connector.gateway.processor.RefundNotificationProcessorTest
[INFO] Running uk.gov.pay.connector.gatewayaccountcredentials.resource.GatewayAccountCredentialsRequestValidatorTest
[INFO] Tests run: 15, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.028 s - in uk.gov.pay.connector.gatewayaccountcredentials.resource.GatewayAccountCredentialsRequestValidatorTest
[INFO] Running uk.gov.pay.connector.payout.PayoutEmitterServiceTest
WARN  [2023-02-04 21:12:32,461] uk.gov.pay.connector.payout.PayoutEmitterService: Unsupported payout event class [class uk.gov.pay.connector.events.model.payout.PayoutEvent]
[INFO] Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 s - in uk.gov.pay.connector.payout.PayoutEmitterServiceTest
[INFO] Running uk.gov.pay.connector.payout.PayoutReconcileProcessTest
ERROR [2023-02-04 21:12:32,694] uk.gov.pay.connector.payout.PayoutReconcileProcess: Error processing payout from SQS message [queueMessageId=null] [errorMessage=Transaction external ID missing in metadata on Stripe transfer for balance transaction [null] for payout [po_123dv3RPEC2XwBWpqiQfnJGQ] for gateway account [acct_2RDpWRLXEC2XwBWp]]
ERROR [2023-02-04 21:12:32,698] uk.gov.pay.connector.payout.PayoutReconcileProcess: No payments or refunds retrieved for payout [po_123dv3RPEC2XwBWpqiQfnJGQ]. Requires investigation.
ERROR [2023-02-04 21:12:32,702] uk.gov.pay.connector.payout.PayoutReconcileProcess: Error processing payout from SQS message [queueMessageId=null] [errorMessage=Error sending PAYMENT_INCLUDED_IN_PAYOUT event for transaction [payment-id] included in payout [po_123dv3RPEC2XwBWpqiQfnJGQ] to event queue: null]
[INFO] Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.242 s - in uk.gov.pay.connector.payout.PayoutReconcileProcessTest
[INFO] Running uk.gov.pay.connector.charge.model.ChargeCreateRequestTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.01 s - in uk.gov.pay.connector.charge.model.ChargeCreateRequestTest
[INFO] Running uk.gov.pay.connector.charge.validation.telephone.CardBrandValidatorTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.02 s - in uk.gov.pay.connector.charge.validation.telephone.CardBrandValidatorTest
[INFO] Running uk.gov.pay.connector.charge.validation.telephone.ZoneDateTimeValidatorTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 s - in uk.gov.pay.connector.charge.validation.telephone.ZoneDateTimeValidatorTest
[INFO] Running uk.gov.pay.connector.charge.validation.telephone.PaymentOutcomeValidatorTest
[INFO] Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.01 s - in uk.gov.pay.connector.charge.validation.telephone.PaymentOutcomeValidatorTest
[INFO] Running uk.gov.pay.connector.charge.validation.telephone.CardLastFourDigitsValidatorTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.015 s - in uk.gov.pay.connector.charge.validation.telephone.CardLastFourDigitsValidatorTest
[INFO] Running uk.gov.pay.connector.charge.validation.telephone.CardFirstSixDigitsValidatorTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.016 s - in uk.gov.pay.connector.charge.validation.telephone.CardFirstSixDigitsValidatorTest
[INFO] Running uk.gov.pay.connector.charge.service.AuthorisationErrorGatewayCleanupServiceTest
ERROR [2023-02-04 21:12:32,817] uk.gov.pay.connector.charge.service.AuthorisationErrorGatewayCleanupService: Charge does not map to an internal charge state. Raw query response was: worldpayQueryResponse
[INFO] Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.024 s - in uk.gov.pay.connector.charge.service.AuthorisationErrorGatewayCleanupServiceTest
[INFO] Running uk.gov.pay.connector.charge.service.ChargeExpiryServiceTest
ERROR [2023-02-04 21:12:32,841] uk.gov.pay.connector.charge.service.ChargeExpiryService: Gateway error while cancelling the Charge - charge_external_id=i8h299gmu95u5iq87hqgttff9a, gateway_error=something went wrong
[INFO] Tests run: 22, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.057 s - in uk.gov.pay.connector.charge.service.ChargeExpiryServiceTest
[INFO] Running uk.gov.pay.connector.charge.service.Worldpay3dsFlexJwtServiceTest
[INFO] Tests run: 12, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.07 s - in uk.gov.pay.connector.charge.service.Worldpay3dsFlexJwtServiceTest
[INFO] Running uk.gov.pay.connector.charge.service.ChargeCancelServiceTest
[INFO] Tests run: 21, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.029 s - in uk.gov.pay.connector.charge.service.ChargeCancelServiceTest
[INFO] Running uk.gov.pay.connector.charge.util.JwtGeneratorTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.charge.util.JwtGeneratorTest
[INFO] Running uk.gov.pay.connector.service.UnknownStatusTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 s - in uk.gov.pay.connector.service.UnknownStatusTest
[INFO] Running uk.gov.pay.connector.service.GatewayClientFactoryTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.service.GatewayClientFactoryTest
[INFO] Running uk.gov.pay.connector.service.IgnoredStatusTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 s - in uk.gov.pay.connector.service.IgnoredStatusTest
[INFO] Running uk.gov.pay.connector.service.MappedChargeStatusTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 s - in uk.gov.pay.connector.service.MappedChargeStatusTest
[INFO] Running uk.gov.pay.connector.service.EpdqExternalRefundAvailabilityCalculatorTest
[INFO] Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 s - in uk.gov.pay.connector.service.EpdqExternalRefundAvailabilityCalculatorTest
[INFO] Running uk.gov.pay.connector.service.MappedRefundStatusTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.service.MappedRefundStatusTest
[INFO] Running uk.gov.pay.connector.service.PaymentProvidersTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.045 s - in uk.gov.pay.connector.service.PaymentProvidersTest
[INFO] Running uk.gov.pay.connector.service.DefaultExternalRefundAvailabilityCalculatorTest
[INFO] Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 s - in uk.gov.pay.connector.service.DefaultExternalRefundAvailabilityCalculatorTest
[INFO] Running uk.gov.pay.connector.gatewayaccount.model.GatewayAccountSearchParamsTest
[INFO] Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 s - in uk.gov.pay.connector.gatewayaccount.model.GatewayAccountSearchParamsTest
[INFO] Running uk.gov.pay.connector.gatewayaccount.resource.GatewayAccountSwitchPaymentProviderRequestValidatorTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.gatewayaccount.resource.GatewayAccountSwitchPaymentProviderRequestValidatorTest
[INFO] Running uk.gov.pay.connector.gatewayaccount.resource.StripeAccountSetupRequestValidatorTest
[INFO] Tests run: 38, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.013 s - in uk.gov.pay.connector.gatewayaccount.resource.StripeAccountSetupRequestValidatorTest
[INFO] Running uk.gov.pay.connector.gatewayaccount.service.StripeAccountSetupServiceTest
[INFO] Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.02 s - in uk.gov.pay.connector.gatewayaccount.service.StripeAccountSetupServiceTest
[INFO] Running uk.gov.pay.connector.gatewayaccount.service.GatewayAccountSwitchPaymentProviderServiceTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 s - in uk.gov.pay.connector.gatewayaccount.service.GatewayAccountSwitchPaymentProviderServiceTest
[INFO] Running uk.gov.pay.connector.gatewayaccount.service.StripeAccountServiceTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.gatewayaccount.service.StripeAccountServiceTest
[INFO] Running uk.gov.pay.connector.events.model.EventTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 s - in uk.gov.pay.connector.events.model.EventTest
[INFO] Running uk.gov.pay.connector.events.model.payout.PayoutUpdatedTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.events.model.payout.PayoutUpdatedTest
[INFO] Running uk.gov.pay.connector.events.model.payout.PayoutPaidTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.events.model.payout.PayoutPaidTest
[INFO] Running uk.gov.pay.connector.events.model.payout.PayoutFailedTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.events.model.payout.PayoutFailedTest
[INFO] Running uk.gov.pay.connector.events.model.payout.PayoutCreatedTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 s - in uk.gov.pay.connector.events.model.payout.PayoutCreatedTest
[INFO] Running uk.gov.pay.connector.events.model.charge.UserEmailCollectedTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 s - in uk.gov.pay.connector.events.model.charge.UserEmailCollectedTest
[INFO] Running uk.gov.pay.connector.events.model.charge.CaptureSubmittedTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.012 s - in uk.gov.pay.connector.events.model.charge.CaptureSubmittedTest
[INFO] Running uk.gov.pay.connector.events.model.charge.BackfillerRecreatedUserEmailCollectedTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.01 s - in uk.gov.pay.connector.events.model.charge.BackfillerRecreatedUserEmailCollectedTest
[INFO] Running uk.gov.pay.connector.events.model.charge.CancelledByUserTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.01 s - in uk.gov.pay.connector.events.model.charge.CancelledByUserTest
[INFO] Running uk.gov.pay.connector.events.model.charge.PaymentDetailsEnteredTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.006 s - in uk.gov.pay.connector.events.model.charge.PaymentDetailsEnteredTest
[INFO] Running uk.gov.pay.connector.events.model.charge.CaptureConfirmedTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 s - in uk.gov.pay.connector.events.model.charge.CaptureConfirmedTest
[INFO] Running uk.gov.pay.connector.events.model.charge.RefundAvailabilityUpdatedTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 s - in uk.gov.pay.connector.events.model.charge.RefundAvailabilityUpdatedTest
[INFO] Running uk.gov.pay.connector.events.model.charge.PaymentIncludedInPayoutTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.events.model.charge.PaymentIncludedInPayoutTest
[INFO] Running uk.gov.pay.connector.events.model.charge.GatewayRequires3dsAuthorisationTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 s - in uk.gov.pay.connector.events.model.charge.GatewayRequires3dsAuthorisationTest
[INFO] Running uk.gov.pay.connector.events.model.refund.EventFactoryTest
[INFO] Tests run: 31, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.032 s - in uk.gov.pay.connector.events.model.refund.EventFactoryTest
[INFO] Running uk.gov.pay.connector.events.model.refund.RefundIncludedInPayoutTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.events.model.refund.RefundIncludedInPayoutTest
[INFO] Running uk.gov.pay.connector.events.model.refund.RefundSucceededTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 s - in uk.gov.pay.connector.events.model.refund.RefundSucceededTest
[INFO] Running uk.gov.pay.connector.events.model.refund.RefundCreatedByUserTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.events.model.refund.RefundCreatedByUserTest
[INFO] Running uk.gov.pay.connector.events.model.refund.RefundCreatedByServiceTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.events.model.refund.RefundCreatedByServiceTest
[INFO] Running uk.gov.pay.connector.events.resource.EmittedEventResourceTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.077 s - in uk.gov.pay.connector.events.resource.EmittedEventResourceTest
[INFO] Running uk.gov.pay.connector.events.EmittedEventsBackfillServiceTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.04 s - in uk.gov.pay.connector.events.EmittedEventsBackfillServiceTest
[INFO] Running uk.gov.pay.connector.events.EventQueueTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.011 s - in uk.gov.pay.connector.events.EventQueueTest
[INFO] Running uk.gov.pay.connector.events.StateTransitionEmitterProcessTest
WARN  [2023-02-04 21:12:33,422] uk.gov.pay.connector.events.StateTransitionEmitterProcess: Failed to emit new event for state transition [eventId=100] [eventType=PaymentEvent] [error=null]
WARN  [2023-02-04 21:12:33,423] uk.gov.pay.connector.events.StateTransitionEmitterProcess: Failed to emit new event for state transition [eventId=100] [eventType=PaymentEvent] [error=null]
WARN  [2023-02-04 21:12:33,423] uk.gov.pay.connector.events.StateTransitionEmitterProcess: Failed to emit new event for state transition [eventId=100] [eventType=PaymentEvent] [error=null]
WARN  [2023-02-04 21:12:33,423] uk.gov.pay.connector.events.StateTransitionEmitterProcess: Failed to emit new event for state transition [eventId=100] [eventType=PaymentEvent] [error=null]
WARN  [2023-02-04 21:12:33,423] uk.gov.pay.connector.events.StateTransitionEmitterProcess: Failed to emit new event for state transition [eventId=100] [eventType=PaymentEvent] [error=null]
WARN  [2023-02-04 21:12:33,423] uk.gov.pay.connector.events.StateTransitionEmitterProcess: Failed to emit new event for state transition [eventId=100] [eventType=PaymentEvent] [error=null]
WARN  [2023-02-04 21:12:33,424] uk.gov.pay.connector.events.StateTransitionEmitterProcess: Failed to emit new event for state transition [eventId=100] [eventType=PaymentEvent] [error=null]
WARN  [2023-02-04 21:12:33,424] uk.gov.pay.connector.events.StateTransitionEmitterProcess: Failed to emit new event for state transition [eventId=100] [eventType=PaymentEvent] [error=null]
WARN  [2023-02-04 21:12:33,424] uk.gov.pay.connector.events.StateTransitionEmitterProcess: Failed to emit new event for state transition [eventId=100] [eventType=PaymentEvent] [error=null]
ERROR [2023-02-04 21:12:33,424] uk.gov.pay.connector.events.StateTransitionEmitterProcess: State transition message failed to process beyond max retries [eventId=100] [eventType=PaymentEvent]:
WARN  [2023-02-04 21:12:33,436] uk.gov.pay.connector.events.StateTransitionEmitterProcess: Failed to emit new event for state transition [eventId=100] [eventType=PaymentEvent] [error=null]
WARN  [2023-02-04 21:12:33,436] uk.gov.pay.connector.events.StateTransitionEmitterProcess: Failed to emit new event for state transition [eventId=100] [eventType=PaymentEvent] [error=null]
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.025 s - in uk.gov.pay.connector.events.StateTransitionEmitterProcessTest
[INFO] Running uk.gov.pay.connector.events.EventServiceTest
ERROR [2023-02-04 21:12:33,440] uk.gov.pay.connector.events.EventService: Failed to emit event PAYMENT_EVENT due to null [externalId=external-id]
ERROR [2023-02-04 21:12:33,441] uk.gov.pay.connector.events.EventService: Failed to emit event PAYMENT_EVENT due to null [externalId=external-id]
ERROR [2023-02-04 21:12:33,442] uk.gov.pay.connector.events.EventService: Failed to emit event PAYMENT_CREATED due to null [externalId=external-id]
[INFO] Tests run: 8, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 s - in uk.gov.pay.connector.events.EventServiceTest
[INFO] Running uk.gov.pay.connector.events.HistoricalEventEmitterServiceTest
[INFO] Tests run: 22, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.061 s - in uk.gov.pay.connector.events.HistoricalEventEmitterServiceTest
[INFO] Running uk.gov.pay.connector.paymentprocessor.service.Card3dsResponseAuthServiceTest
WARN  [2023-02-04 21:12:33,522] uk.gov.pay.connector.charge.model.domain.ChargeEntity: Charge with state AUTHORISATION READY cannot proceed to AUTHORISATION 3DS READY [charge_external_id=7i2ic57sa4ti4ubi2gu3r2crlv, charge_status=AUTHORISATION 3DS READY, event=Event{resourceExternalId='null', eventDetails=uk.gov.pay.connector.events.eventdetails.EmptyEventDetails, timestamp=null}]
WARN  [2023-02-04 21:12:33,524] uk.gov.pay.connector.charge.model.domain.ChargeEntity: Charge with state AUTHORISATION 3DS READY cannot proceed to AUTHORISATION 3DS READY [charge_external_id=m8ocnqrhspp1qtukcoj7j1213n, charge_status=AUTHORISATION 3DS READY, event=Event{resourceExternalId='null', eventDetails=uk.gov.pay.connector.events.eventdetails.EmptyEventDetails, timestamp=null}]
WARN  [2023-02-04 21:12:33,530] uk.gov.pay.connector.charge.model.domain.ChargeEntity: Charge with state EXPIRED cannot proceed to AUTHORISATION 3DS READY [charge_external_id=qrg4laquq088u88sh7lnv6ssr8, charge_status=AUTHORISATION 3DS READY, event=Event{resourceExternalId='null', eventDetails=uk.gov.pay.connector.events.eventdetails.EmptyEventDetails, timestamp=null}]
[INFO] Tests run: 15, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.028 s - in uk.gov.pay.connector.paymentprocessor.service.Card3dsResponseAuthServiceTest
[INFO] Running uk.gov.pay.connector.paymentprocessor.service.CardCaptureServiceTest
ERROR [2023-02-04 21:12:33,537] uk.gov.pay.connector.paymentprocessor.service.CardCaptureService: CAPTURE_ERROR for charge [charge_external_id=external-id] - reached maximum number of capture attempts
WARN  [2023-02-04 21:12:33,540] uk.gov.pay.connector.paymentprocessor.service.CardCaptureService: Failed to create fee incurred event [9slvldsoklsfskgsqpkkf7tkvu], exception: [Event id = [9slvldsoklsfskgsqpkkf7tkvu], exception = Failed to create FeeIncurredEvent due to no fees present on charge]
WARN  [2023-02-04 21:12:33,542] uk.gov.pay.connector.charge.model.domain.ChargeEntity: Charge with state CAPTURE READY cannot proceed to CAPTURE READY [charge_external_id=o8ta9phru4t9sfu2vbjqjn6ra5, charge_status=CAPTURE READY, event=Event{resourceExternalId='null', eventDetails=uk.gov.pay.connector.events.eventdetails.EmptyEventDetails, timestamp=null}]
WARN  [2023-02-04 21:12:33,544] uk.gov.pay.connector.paymentprocessor.service.CardCaptureService: Failed to create fee incurred event [qukucsj5htcebfp51vdrt6tvmp], exception: [Event id = [qukucsj5htcebfp51vdrt6tvmp], exception = Failed to create FeeIncurredEvent due to no fees present on charge]
WARN  [2023-02-04 21:12:33,547] uk.gov.pay.connector.paymentprocessor.service.CardCaptureService: Card capture response received with no transaction id. - charge_external_id=3g5n31g118eeijrme8r0vmo6b3
WARN  [2023-02-04 21:12:33,547] uk.gov.pay.connector.paymentprocessor.service.CardCaptureService: Failed to create fee incurred event [3g5n31g118eeijrme8r0vmo6b3], exception: [Event id = [3g5n31g118eeijrme8r0vmo6b3], exception = Failed to create FeeIncurredEvent due to no fees present on charge]
WARN  [2023-02-04 21:12:33,550] uk.gov.pay.connector.charge.model.domain.ChargeEntity: Charge with state ENTERING CARD DETAILS cannot proceed to CAPTURE READY [charge_external_id=em2uh1bndquo6fdjdqmma8p58b, charge_status=CAPTURE READY, event=Event{resourceExternalId='null', eventDetails=uk.gov.pay.connector.events.eventdetails.EmptyEventDetails, timestamp=null}]
ERROR [2023-02-04 21:12:33,551] uk.gov.pay.connector.paymentprocessor.service.CardCaptureService: CAPTURE_ERROR for charge [charge_external_id=al7lepfhtlar6leb7vckkph8ae] - reached maximum number of capture attempts
WARN  [2023-02-04 21:12:33,553] uk.gov.pay.connector.paymentprocessor.service.CardCaptureService: Failed to create fee incurred event [mi1man7q0t1ole0anhc98g5l0i], exception: [Event id = [mi1man7q0t1ole0anhc98g5l0i], exception = Failed to create FeeIncurredEvent due to no fees present on charge]
WARN  [2023-02-04 21:12:33,557] uk.gov.pay.connector.paymentprocessor.service.CardCaptureService: Failed to create fee incurred event [uhn590o9jirjvbs7bf9mvjk7mt], exception: [Event id = [uhn590o9jirjvbs7bf9mvjk7mt], exception = Failed to create FeeIncurredEvent due to no fees present on charge]
WARN  [2023-02-04 21:12:33,564] uk.gov.pay.connector.paymentprocessor.service.CardCaptureService: Failed to create fee incurred event [ngtp8f2bec3qes66fq8brps2rg], exception: [Event id = [ngtp8f2bec3qes66fq8brps2rg], exception = Failed to create FeeIncurredEvent due to no fees present on charge]
WARN  [2023-02-04 21:12:33,567] uk.gov.pay.connector.paymentprocessor.service.CardCaptureService: Failed to create fee incurred event [edj33t30t651i7sovecn5l3753], exception: [Event id = [edj33t30t651i7sovecn5l3753], exception = Failed to create FeeIncurredEvent due to no fees present on charge]
[INFO] Tests run: 14, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.034 s - in uk.gov.pay.connector.paymentprocessor.service.CardCaptureServiceTest
[INFO] Running uk.gov.pay.connector.paymentprocessor.service.CardCaptureProcessTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.017 s - in uk.gov.pay.connector.paymentprocessor.service.CardCaptureProcessTest
[INFO] Running uk.gov.pay.connector.report.resource.ParityCheckerResourceTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.074 s - in uk.gov.pay.connector.report.resource.ParityCheckerResourceTest
[INFO] Running uk.gov.pay.connector.report.ParityCheckerServiceTest
[INFO] Tests run: 13, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.032 s - in uk.gov.pay.connector.report.ParityCheckerServiceTest
[INFO] Running uk.gov.pay.connector.filters.SchemeRewriteFilterTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 s - in uk.gov.pay.connector.filters.SchemeRewriteFilterTest
[INFO] Running uk.gov.pay.connector.app.RestClientFactoryTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.01 s - in uk.gov.pay.connector.app.RestClientFactoryTest
[INFO] Running uk.gov.pay.connector.app.validator.SqsConfigValidatorTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.01 s - in uk.gov.pay.connector.app.validator.SqsConfigValidatorTest
[INFO] Running uk.gov.pay.connector.expunge.service.ChargeExpungeServiceTest
[MockitoHint] ChargeExpungeServiceTest.expunge_shouldNotExpungeCharge__whenInAuthorisationErrorState (see javadoc for MockitoHint):
[MockitoHint] 1. Unused -> at uk.gov.pay.connector.expunge.service.ChargeExpungeServiceTest.expunge_shouldNotExpungeCharge__whenInAuthorisationErrorState(ChargeExpungeServiceTest.java:176)

[INFO] Tests run: 18, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.028 s - in uk.gov.pay.connector.expunge.service.ChargeExpungeServiceTest
[INFO] Running uk.gov.pay.connector.expunge.service.ExpungeServiceTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 s - in uk.gov.pay.connector.expunge.service.ExpungeServiceTest
[INFO] Running uk.gov.pay.connector.expunge.service.RefundExpungeServiceTest
[INFO] Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 s - in uk.gov.pay.connector.expunge.service.RefundExpungeServiceTest
[INFO] Running uk.gov.pay.connector.chargeevent.model.domain.LocalDateTimeConverterTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.chargeevent.model.domain.LocalDateTimeConverterTest
[INFO] Running uk.gov.pay.connector.northamericaregion.CanadaPostalcodeToProvinceOrTerritoryMapperTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 s - in uk.gov.pay.connector.northamericaregion.CanadaPostalcodeToProvinceOrTerritoryMapperTest
[INFO] Running uk.gov.pay.connector.northamericaregion.UsZipCodeToStateMapperTest
[INFO] Tests run: 8, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.northamericaregion.UsZipCodeToStateMapperTest
[INFO] Running uk.gov.pay.connector.northamericaregion.NorthAmericanRegionMapperTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.northamericaregion.NorthAmericanRegionMapperTest
[INFO] Running uk.gov.pay.connector.util.WorldpayXMLUnmarshallerTest
[INFO] Tests run: 13, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.053 s - in uk.gov.pay.connector.util.WorldpayXMLUnmarshallerTest
[INFO] Running uk.gov.pay.connector.util.ReverseDnsLookupTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.024 s - in uk.gov.pay.connector.util.ReverseDnsLookupTest
[INFO] Running uk.gov.pay.connector.util.ApplicationStartupApplicationStartupDependentResourceCheckerTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.02 s - in uk.gov.pay.connector.util.ApplicationStartupApplicationStartupDependentResourceCheckerTest
[INFO] Running uk.gov.pay.connector.util.SmartpayXMLUnmarshallerTest
[INFO] Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.026 s - in uk.gov.pay.connector.util.SmartpayXMLUnmarshallerTest
[INFO] Running uk.gov.pay.connector.util.XMLUnmarshallerSecurityTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.014 s - in uk.gov.pay.connector.util.XMLUnmarshallerSecurityTest
[INFO] Running uk.gov.pay.connector.util.JsonObjectMapperTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 s - in uk.gov.pay.connector.util.JsonObjectMapperTest
[INFO] Running uk.gov.pay.connector.util.DnsPointerResourceRecordTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 s - in uk.gov.pay.connector.util.DnsPointerResourceRecordTest
[INFO] Running uk.gov.pay.connector.util.IpDomainMatcherTest
ERROR [2023-02-04 21:12:33,920] uk.gov.pay.connector.util.IpDomainMatcher: Reverse DNS Lookup failed: Host not found for ip address 'not-an-ip'
ERROR [2023-02-04 21:12:33,920] uk.gov.pay.connector.util.IpDomainMatcher: Reverse DNS Lookup failed: null
ERROR [2023-02-04 21:12:33,922] uk.gov.pay.connector.util.IpDomainMatcher: Reverse DNS lookup on ip '8.8.8.8' - resolved domain 'dns.google.' does not match 'worldpay.com'
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 s - in uk.gov.pay.connector.util.IpDomainMatcherTest
[INFO] Running uk.gov.pay.connector.util.RandomIdGeneratorTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.016 s - in uk.gov.pay.connector.util.RandomIdGeneratorTest
[INFO] Running uk.gov.pay.connector.util.DateTimeUtilsTest
[INFO] Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.016 s - in uk.gov.pay.connector.util.DateTimeUtilsTest
[INFO] Running uk.gov.pay.connector.util.EpdqXMLUnmarshallerTest
[INFO] Tests run: 11, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.031 s - in uk.gov.pay.connector.util.EpdqXMLUnmarshallerTest
[INFO] Running uk.gov.pay.connector.common.model.domain.PrefilledAddressTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 s - in uk.gov.pay.connector.common.model.domain.PrefilledAddressTest
[INFO] Running uk.gov.pay.connector.common.model.domain.PaymentGatewayStateTransitionsTest
[INFO] Tests run: 41, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 s - in uk.gov.pay.connector.common.model.domain.PaymentGatewayStateTransitionsTest
[INFO] Running uk.gov.pay.connector.common.model.domain.NumbersInStringsSanitizerTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.common.model.domain.NumbersInStringsSanitizerTest
[INFO] Running uk.gov.pay.connector.common.model.api.ExternalRefundStatusMapTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.common.model.api.ExternalRefundStatusMapTest
[INFO] Running uk.gov.pay.connector.queue.payout.PayoutReconcileQueueTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 s - in uk.gov.pay.connector.queue.payout.PayoutReconcileQueueTest
[INFO] Running uk.gov.pay.connector.queue.StateTransitionQueueTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.301 s - in uk.gov.pay.connector.queue.StateTransitionQueueTest
[INFO] Running uk.gov.pay.connector.queue.CaptureQueueTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.006 s - in uk.gov.pay.connector.queue.CaptureQueueTest
[INFO] Running uk.gov.pay.connector.queue.StateTransitionServiceTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.017 s - in uk.gov.pay.connector.queue.StateTransitionServiceTest
[INFO] Running uk.gov.pay.connector.wallets.applepay.ApplePayServiceTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.013 s - in uk.gov.pay.connector.wallets.applepay.ApplePayServiceTest
[INFO] Running uk.gov.pay.connector.wallets.googlepay.api.GooglePayAuthRequestTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 s - in uk.gov.pay.connector.wallets.googlepay.api.GooglePayAuthRequestTest
[INFO] Running uk.gov.pay.connector.wallets.googlepay.GooglePayServiceTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 s - in uk.gov.pay.connector.wallets.googlepay.GooglePayServiceTest
[INFO] Running uk.gov.pay.connector.wallets.WalletAuthoriseServiceForGooglePay3dsTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.013 s - in uk.gov.pay.connector.wallets.WalletAuthoriseServiceForGooglePay3dsTest
[INFO] Running uk.gov.pay.connector.wallets.WalletAuthoriseServiceTest
ERROR [2023-02-04 21:12:34,371] uk.gov.pay.connector.wallets.WalletAuthoriseService: Error occurred authorising charge. Charge external id: aulipjit0utj86l7sme4bsksqs; message: Mock for WorldpayOrderStatusResponse, hashCode: 1166411363
WARN  [2023-02-04 21:12:34,371] uk.gov.pay.connector.paymentprocessor.service.AuthorisationService: AuthCardDetails authorisation response received with no transaction id. -  charge_external_id=aulipjit0utj86l7sme4bsksqs
WARN  [2023-02-04 21:12:34,375] uk.gov.pay.connector.charge.model.domain.ChargeEntity: Charge with state UNDEFINED cannot proceed to AUTHORISATION READY [charge_external_id=fi3jhlmo9nq7asoogp401avn94, charge_status=AUTHORISATION READY, event=Event{resourceExternalId='null', eventDetails=uk.gov.pay.connector.events.eventdetails.EmptyEventDetails, timestamp=null}]
WARN  [2023-02-04 21:12:34,397] uk.gov.pay.connector.charge.model.domain.ChargeEntity: Charge with state AUTHORISATION READY cannot proceed to AUTHORISATION READY [charge_external_id=0bfdu8o7fetqp92dfsb86t74hq, charge_status=AUTHORISATION READY, event=Event{resourceExternalId='null', eventDetails=uk.gov.pay.connector.events.eventdetails.EmptyEventDetails, timestamp=null}]
ERROR [2023-02-04 21:12:34,404] uk.gov.pay.connector.wallets.WalletAuthoriseService: Error occurred authorising charge. Charge external id: ji61qth743849fn3k6vn9tqt4c; message: Malformed response received
ERROR [2023-02-04 21:12:34,405] uk.gov.pay.connector.wallets.WalletAuthoriseService: Response from gateway: null
WARN  [2023-02-04 21:12:34,405] uk.gov.pay.connector.paymentprocessor.service.AuthorisationService: AuthCardDetails authorisation response received with no transaction id. -  charge_external_id=ji61qth743849fn3k6vn9tqt4c
ERROR [2023-02-04 21:12:34,419] uk.gov.pay.connector.wallets.WalletAuthoriseService: Error occurred authorising charge. Charge external id: s6ruc0dnp8ksgnl86c7bbtjk2u; message: Mock for WorldpayOrderStatusResponse, hashCode: 1935763269
WARN  [2023-02-04 21:12:34,419] uk.gov.pay.connector.paymentprocessor.service.AuthorisationService: AuthCardDetails authorisation response received with no transaction id. -  charge_external_id=s6ruc0dnp8ksgnl86c7bbtjk2u
ERROR [2023-02-04 21:12:34,429] uk.gov.pay.connector.wallets.WalletAuthoriseService: Error occurred authorising charge. Charge external id: e3pkse85p4fh7i3am9acn77rb8; message: Connection timed out
WARN  [2023-02-04 21:12:34,429] uk.gov.pay.connector.paymentprocessor.service.AuthorisationService: AuthCardDetails authorisation response received with no transaction id. -  charge_external_id=e3pkse85p4fh7i3am9acn77rb8
ERROR [2023-02-04 21:12:34,438] uk.gov.pay.connector.wallets.WalletAuthoriseService: Error occurred authorising charge. Charge external id: btav2m56bfmhr2ipgq4ecnb4it; message: Mock for WorldpayOrderStatusResponse, hashCode: 86465655
WARN  [2023-02-04 21:12:34,439] uk.gov.pay.connector.paymentprocessor.service.AuthorisationService: AuthCardDetails authorisation response received with no transaction id. -  charge_external_id=btav2m56bfmhr2ipgq4ecnb4it
[INFO] Tests run: 17, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.077 s - in uk.gov.pay.connector.wallets.WalletAuthoriseServiceTest
[INFO] Running uk.gov.pay.connector.tasks.service.ChargeParityCheckerTest
[INFO] Tests run: 22, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.041 s - in uk.gov.pay.connector.tasks.service.ChargeParityCheckerTest
[INFO] Running uk.gov.pay.connector.tasks.service.RefundParityCheckerTest
[INFO] Tests run: 8, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 s - in uk.gov.pay.connector.tasks.service.RefundParityCheckerTest
[INFO] Running uk.gov.pay.connector.tasks.ParityCheckServiceTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 s - in uk.gov.pay.connector.tasks.ParityCheckServiceTest
[INFO] Running uk.gov.pay.connector.usernotification.model.NotificationsTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 s - in uk.gov.pay.connector.usernotification.model.NotificationsTest
[INFO] Running uk.gov.pay.connector.usernotification.model.EvaluatedChargeStatusNotificationTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.usernotification.model.EvaluatedChargeStatusNotificationTest
[INFO] Running uk.gov.pay.connector.usernotification.model.EvaluatedRefundStatusNotificationTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.usernotification.model.EvaluatedRefundStatusNotificationTest
[INFO] Running uk.gov.pay.connector.usernotification.service.UserNotificationServiceTest
WARN  [2023-02-04 21:12:34,546] uk.gov.pay.connector.usernotification.service.UserNotificationService: Email notifications is disabled by configuration
ERROR [2023-02-04 21:12:34,574] uk.gov.pay.connector.usernotification.service.UserNotificationService: Failed to send PAYMENT_CONFIRMED email - charge_external_id=rfn6ngam4rbllt6ff0t993pu5c
! uk.gov.service.notify.NotificationClientException: null
WARN  [2023-02-04 21:12:34,620] uk.gov.pay.connector.usernotification.service.UserNotificationService: Cannot send email for charge_external_id = 2lgidg816jd669elh88va76k20 because the charge does not have an email address
ERROR [2023-02-04 21:12:34,633] uk.gov.pay.connector.usernotification.service.UserNotificationService: Failed to send REFUND_ISSUED email - charge_external_id=jrnmotnm2oacc3glg47ddrre9j
! uk.gov.service.notify.NotificationClientException: null
WARN  [2023-02-04 21:12:34,637] uk.gov.pay.connector.usernotification.service.UserNotificationService: Email notifications is disabled by configuration
[INFO] Tests run: 23, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.133 s - in uk.gov.pay.connector.usernotification.service.UserNotificationServiceTest
[INFO] Running uk.gov.pay.connector.usernotification.service.GatewayAccountNotificationCredentialsServiceTest
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 s - in uk.gov.pay.connector.usernotification.service.GatewayAccountNotificationCredentialsServiceTest
[INFO] Running uk.gov.pay.connector.usernotification.service.UserNotificationServiceEmailCollectionModeTest
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.012 s - in uk.gov.pay.connector.usernotification.service.UserNotificationServiceEmailCollectionModeTest
[INFO] Running uk.gov.pay.connector.resources.PerformanceReportResourceTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.016 s - in uk.gov.pay.connector.resources.PerformanceReportResourceTest
[INFO] Running uk.gov.pay.connector.resources.ApiValidatorsTest
[INFO] Tests run: 23, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.018 s - in uk.gov.pay.connector.resources.ApiValidatorsTest
[INFO] Running uk.gov.pay.connector.resources.AuthCardDetailsValidatorTest
[INFO] Tests run: 52, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.022 s - in uk.gov.pay.connector.resources.AuthCardDetailsValidatorTest
[INFO] Running uk.gov.pay.connector.resources.GatewayAccountPerformanceReportResourceTest
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.resources.GatewayAccountPerformanceReportResourceTest
[INFO] Running uk.gov.pay.connector.it.util.XMLUnmarshallerTest
[ERROR] Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 0.183 s <<< FAILURE! - in uk.gov.pay.connector.it.util.XMLUnmarshallerTest
[ERROR] uk.gov.pay.connector.it.util.XMLUnmarshallerTest.shouldUnmarshallXmlIgnoringDTD  Time elapsed: 0.18 s  <<< ERROR!
java.lang.NoClassDefFoundError: org/eclipse/jetty/io/ChannelEndPoint
	at com.github.tomakehurst.wiremock.jetty9.JettyHttpServer.createServerConnector(JettyHttpServer.java:345)
	at com.github.tomakehurst.wiremock.jetty94.Jetty94HttpServer.createHttpConnector(Jetty94HttpServer.java:70)
	at com.github.tomakehurst.wiremock.jetty9.JettyHttpServer.<init>(JettyHttpServer.java:88)
	at com.github.tomakehurst.wiremock.jetty94.Jetty94HttpServer.<init>(Jetty94HttpServer.java:45)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)
	at com.github.tomakehurst.wiremock.jetty9.JettyHttpServerFactory.buildHttpServer(JettyHttpServerFactory.java:73)
	at com.github.tomakehurst.wiremock.WireMockServer.<init>(WireMockServer.java:75)
	at com.github.tomakehurst.wiremock.junit.WireMockRule.<init>(WireMockRule.java:36)
	at com.github.tomakehurst.wiremock.junit.WireMockRule.<init>(WireMockRule.java:32)
	at uk.gov.pay.connector.it.util.XMLUnmarshallerTest.<init>(XMLUnmarshallerTest.java:24)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)
	at org.junit.runners.BlockJUnit4ClassRunner.createTest(BlockJUnit4ClassRunner.java:250)
	at org.junit.runners.BlockJUnit4ClassRunner.createTest(BlockJUnit4ClassRunner.java:260)
	at org.junit.runners.BlockJUnit4ClassRunner$2.runReflectiveCall(BlockJUnit4ClassRunner.java:309)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.BlockJUnit4ClassRunner.methodBlock(BlockJUnit4ClassRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:42)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:80)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:72)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:55)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:223)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:175)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:139)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:456)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:169)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:595)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:581)
Caused by: java.lang.ClassNotFoundException: org.eclipse.jetty.io.ChannelEndPoint
	at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:581)
	at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:178)
	at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:522)
	... 54 more

[INFO] Running uk.gov.pay.connector.it.resources.PayersCardTypesResourceITest
[WARNING] Tests run: 6, Failures: 0, Errors: 0, Skipped: 5, Time elapsed: 0.066 s - in uk.gov.pay.connector.it.resources.PayersCardTypesResourceITest
[INFO] Running uk.gov.pay.connector.agreement.service.AgreementServiceTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 s - in uk.gov.pay.connector.agreement.service.AgreementServiceTest
[INFO] Running uk.gov.pay.connector.healthcheck.PingTest
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 s - in uk.gov.pay.connector.healthcheck.PingTest
[INFO] 
[INFO] Results:
[INFO] 
[ERROR] Errors: 
[ERROR]   XMLUnmarshallerTest.<init>:24  NoClassDefFound org/eclipse/jetty/io/ChannelEndPoint
[INFO] 
[ERROR] Tests run: 1887, Failures: 0, Errors: 1, Skipped: 7
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  30.401 s
[INFO] Finished at: 2023-02-04T21:12:35Z
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:3.0.0-M7:test (default-test) on project pay-connector: 
[ERROR] 
[ERROR] Please refer to /home/gabsko/breaking-updates/target/surefire-reports for the individual test results.
[ERROR] Please refer to dump files (if any exist) [date].dump, [date]-jvmRun[N].dump and [date].dumpstream.
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
